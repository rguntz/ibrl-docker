# SERL Teleop System Configuration
# This file contains all configurable parameters for the teleop and recording system

# =============================================================================
# TELEOP CLIENT CONFIGURATION
# =============================================================================

teleop:
  # Camera rendering settings
  camera:
    # Resolution for rendering camera images (width x height)
    # This determines the output size of rendered images from MuJoCo
    # Higher = better quality but more bandwidth/network usage
    resolution: [640, 480]  # [width, height] pixels

    # Camera names to capture (must match MuJoCo XML camera names)
    names: ["cam_high", "cam_low", "cam_left_wrist", "cam_right_wrist"]

  # Data transmission settings
  data:
    # How often to sample data from MuJoCo loop (Hz)
    # MuJoCo typically runs at ~500Hz, we sample at this rate
    # This limits the maximum recording FPS in the UI
    sample_rate: 30  # Hz

    # ZeroMQ port for data transmission to server
    zmq_port: 5556

  # Robot connection settings
  robots:
    # IP addresses for leader robots
    leader_left_ip: "192.168.1.2"
    leader_right_ip: "192.168.1.3"

  # Visualization settings
  visualization:
    # Whether to show MuJoCo viewer window
    enabled: true

  # Warm-up sequence settings (for data diversity)
  warmup:
    # Whether to perform warm-up sequence before teleop
    enabled: true

    # Cube randomization settings
    cube:
      # Position ranges for random cube spawning [x_min, x_max, y_min, y_max, z_fixed]
      position_ranges: [-0.1, 0.2, -0.15, 0.15, 0.0125]  # x, y, z (z fixed on table)

    # Robot starting position settings
    robots:
      # Home position for leader robots (joint angles in radians)
      # Format: [j1, j2, j3, j4, j5, j6, gripper]
      home_position: [0.0, 1.57, 1.57, 0.0, 0.0, 0.0, 0.0]  # ~90° elbow bend

      # Randomization ranges for starting positions (added to home position)
      # Format: [[j1_min, j1_max], [j2_min, j2_max], ...]
      randomization_ranges:
        - [-0.2, 0.2]   # Joint 1: ±0.2 rad (~11°)
        - [-0.3, 0.3]   # Joint 2: ±0.3 rad (~17°)
        - [-0.3, 0.3]   # Joint 3: ±0.3 rad (~17°)
        - [-0.2, 0.2]   # Joint 4: ±0.2 rad (~11°)
        - [-0.2, 0.2]   # Joint 5: ±0.2 rad (~11°)
        - [-0.2, 0.2]   # Joint 6: ±0.2 rad (~11°)
        - [0.0, 0.0]    # Gripper: no randomization (keep open)

    # Timing settings
    timing:
      # Time to move robots to starting positions (seconds)
      robot_move_time: 2.0

      # Time to wait after movements for stabilization (seconds)
      stabilization_time: 1.0

      # Total warm-up duration (calculated automatically)
      # robot_move_time + stabilization_time

# =============================================================================
# RECORDING SERVER CONFIGURATION
# =============================================================================

server:
  # Network settings
  network:
    # ZeroMQ port for receiving teleop data
    zmq_port: 5556

    # HTTP port for web UI
    http_port: 5000

  # Recording settings
  recording:
    # Maximum FPS for episode recording (limited by teleop data rate)
    # Must be <= teleop.data.sample_rate
    max_fps: 30

    # Default FPS shown in UI
    default_fps: 15

    # Directory to save recorded episodes
    save_path: "data"

  # Warm-up system settings
  warmup:
    # Whether server should expect warm-up sequence from teleop client
    expect_warmup: true

    # Timeout for warm-up completion (seconds)
    warmup_timeout: 10.0

# =============================================================================
# SYSTEM CONSTRAINTS & VALIDATION
# =============================================================================

constraints:
  # Data flow: MuJoCo (~500Hz) -> Sample (30Hz) -> Record (1-30Hz)
  mujoco_frequency: "~500Hz"  # Determined by mj_model.opt.timestep

  # Resolution flow: All components use same resolution (no conversion)
  resolution_flow: "MuJoCo Render -> ZeroMQ -> Camera Buffer -> UI Stream -> Recorder"

  # Validation rules
  validation:
    recording_fps_range: [1, 30]  # Must be within this range
    camera_resolution_min: [320, 240]  # Minimum acceptable resolution
    camera_resolution_max: [1920, 1080]  # Maximum acceptable resolution

# =============================================================================
# USAGE NOTES
# =============================================================================

notes:
  - "Camera resolution affects bandwidth: higher = more data transfer"
  - "Sample rate limits max recording FPS: increase for higher FPS recording"
  - "MuJoCo frequency is determined by XML timestep, typically ~500Hz"
  - "All resolutions stay the same throughout pipeline (no conversion)"
  - "Recording FPS validation prevents exceeding available data rate"